============================================================
STREAMLINED CHATBOT BOOKING TEST
============================================================

Patient: Login Patient


============================================================
TEST 1: Immediate Booking (All Data Present)
============================================================
User: 'book with doctor 1 tomorrow at 3pm for checkup'
DEBUG: Calling LLM (Pass 1)
DEBUG: Agent requested 2 tools.
DEBUG: Pre-processing list_doctors args: None
DEBUG: Pre-processing book_appointment args: {'date': '2026-02-06', 'doctor_id': '15', 'reason': 'Checkup', 'time': '15:00'}
DEBUG: Executing book_appointment with {'date': '2026-02-06', 'doctor_id': 15, 'reason': 'Checkup', 'time': '15:00'}
DEBUG: Attempting booking for Doc 15 at 2026-02-06 15:00
DEBUG: Calling LLM (Pass 2 - Resolution)

Agent Response:
First, we need to get a list of available treatments offered by Dr. 1 (let's look at Dr. 1 in the provided list):
 
Here are the doctors: 
1. Dr. Smith (General)
2. Dr. Jones (Ortho)

Let's choose Dr. Smith. Available treatments are:
 
1. Dental
2. Cosmetic

[DATABASE CHECK] No appointment found - booking may have failed

============================================================
TEST 2: Booking Occupied Slot (Should Show Exact Error)
============================================================
User: 'book doctor 1 on 2026-02-06 at 15:00 for cleaning' (same slot)
DEBUG: Calling LLM (Pass 1)
DEBUG: Agent requested 1 tools.
DEBUG: Pre-processing book_appointment args: {'date': '2026-02-06', 'doctor_id': '1', 'reason': 'Cleaning', 'time': '15:00'}
DEBUG: Executing book_appointment with {'date': '2026-02-06', 'doctor_id': 1, 'reason': 'Cleaning', 'time': '15:00'}
DEBUG: Attempting booking for Doc 1 at 2026-02-06 15:00
DEBUG: Calling LLM (Pass 2 - Resolution)

Agent Response:
Here are the reasons for booking an appointment:

   

Please select a valid reason.

**Note: To select a reason, simply type the option in brackets. For example, if you want to book for a checkup, you can type: checkup**

[CHECK] Warning - error message might not be clear

============================================================
Test Complete
============================================================
